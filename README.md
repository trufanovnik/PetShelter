# PetShelter

Платформа-агрегатор для приютов домашних животных. Приюты могут вести свои странички и публиковать питомцев, а пользователи — подбирать питомцев по городу и виду животного, ставить лайки, комментировать и сохранять понравившихся.

## Возможности
- Регистрация и аутентификация пользователей и приютов (JWT)
- Просмотр списка приютов и их питомцев
- Фильтрация питомцев по городу приюта и виду (кот, собака, другое)
- Лайки и комментарии к питомцам
- Просмотр списка понравившихся питомцев
- Ведение страниц приютов
- Логирование ошибок в отдельный сервис

## Архитектура и стек технологий
- **Spring Boot** (Web, Security, Data JPA, Validation)
- **Spring Security** с JWT
- **MapStruct** (маппинг DTO)
- **PostgreSQL** (через JPA/Hibernate)
- **Flyway** (миграции и тестовые данные)
- **Feign** (межсервисное взаимодействие)
- **Kafka** (асинхронная отправка логов)
- **Docker** (main-app, log-service, kafka, postgres)
- **Maven** (мульти-модульный проект)

### Модули
- `main-app` — основной backend (REST API, бизнес-логика)
- `log-service` — сервис для сбора и хранения логов ошибок
- `shared` — общие DTO для взаимодействия между сервисами

## Быстрый старт через Docker Compose

1. **Клонируйте репозиторий:**
   ```bash
   git clone https://github.com/trufanovnik/PetShelter/tree/main
   ```
2. **Соберите проект:**
   ```bash
   mvn clean package -DskipTests
   ```
3. **Соберите и запустите сервисы:**
   ```bash
   docker-compose up --build
   ```
   После запуска система будет доступна:

   - Основное приложение: http://localhost:8080

   - Лог-сервис: http://localhost:8081

   - Kafka: localhost:9092 (для приложений), localhost:29092 (для внешних клиентов)

   - PostgreSQL (основная БД): localhost:5432 (логин: main_user, пароль: main_password)

   - PostgreSQL (логи): localhost:5433 (логин: logs_user, пароль: logs_password)

> **Примечание:** Все необходимые настройки (БД, JWT-секреты) заданы в `application.properties` для учебных целей. Вы можете изменить их под себя.

## Миграции и тестовые данные
- Используется **Flyway**: при первом запуске main-app автоматически создаются таблицы и наполняются тестовыми данными (см. `main-app/src/main/resources/db/migration/`).
- Можно использовать собственную базу данных, изменив настройки в `application.properties`.

## Структура репозитория
```
PetShelter/
├── main-app/      # основной backend сервис
├── log-service/   # сервис логирования ошибок
├── shared/        # общие DTO
├── docker-compose.yml
└── pom.xml        # корневой pom для Maven
```

## Контакты
Труфанов Никита

trufanovwork@gmail.com

---